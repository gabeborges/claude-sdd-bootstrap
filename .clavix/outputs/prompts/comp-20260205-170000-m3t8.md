---
id: comp-20260205-170000-m3t8
depthUsed: comprehensive
timestamp: 2026-02-05T17:00:00Z
executed: false
originalPrompt: "based on CLAUDE.md, AGENTS.md, claude/commands/orchestrate.md, and agents/instructions.md, analyze agents/swarm-config.md, fix any mismatch and improve it based on your knowledge about Claude code agents. This is a config file for agents orchestratation."
---

# Improved Prompt

# Fix and Align agents/swarm-config.md with Authoritative Sources

## Objective
Fix all inconsistencies in `agents/swarm-config.md` against the 4 authoritative sources. This file is the swarm configuration reference for the `/orchestrate` command — it maps agents to tiers, defines auto-detection triggers, and provides the teammate prompt template. It must be perfectly aligned with the sources above it.

## Authoritative Sources (in order)
1. **AGENTS.md** — canonical agent roster, 6-tier DAG, SDD artifact flow, prerequisite rules
2. **CLAUDE.md** — project rules, SDD artifact flow, security guardrails
3. **claude/commands/orchestrate.md** — the skill that consumes this config
4. **agents/instructions.md** — supplementary I/O reference (just updated)
5. **agents/swarm-config.md** — the file being corrected (lowest authority)

When swarm-config.md conflicts with any of the above, the higher-authority source wins.

## Known Inconsistencies to Fix

### Category A: Wrong Tier DAG (7 tiers → 6 tiers)
The Tier Dependency DAG (lines 27-35) shows 7 tiers that do NOT match AGENTS.md:
```
Current (wrong):
T1: context-manager
T2: spec-writer
T3: project-task-planner, ui-designer, security-engineer, compliance-engineer
T4: ui-designer | security-engineer | compliance-engineer  (CONFLICTS with roster table which puts them at T3)
T5: frontend-designer | database-administrator
T6: fullstack-developer | test-automator
T7: qa | code-reviewer | auditors
```

The roster table (lines 7-23) ALSO has wrong tiers:
- `spec-writer` at T2 but `project-task-planner` at T3 — AGENTS.md puts both in T2 (sequential within tier)
- `architect` missing entirely
- `knowledge-synthesizer` missing entirely

Correct (per AGENTS.md):
```
Tier 1: workflow-orchestrator, context-manager, knowledge-synthesizer
Tier 2: spec-writer → architect → project-task-planner (sequential)
Tier 3: ui-designer, security-engineer, compliance-engineer (parallel)
Tier 4: frontend-designer, database-administrator (parallel)
Tier 5: fullstack-developer, test-automator (parallel)
Tier 6: qa, debugger, code-reviewer, security-auditor, compliance-auditor (parallel)
```

### Category B: Missing Agents in Roster Table
- `architect` — not in the roster table at all. Per AGENTS.md: Tier 2 (sequential after spec-writer), trigger: after spec-writer completes OR system design needed
- `knowledge-synthesizer` — not in the roster table. Per AGENTS.md: Tier 1, always spawned, trigger: deviation/spec break detected
- `workflow-orchestrator` — not listed (it IS the orchestrator, but AGENTS.md DAG includes it in T1)

Note: architect and knowledge-synthesizer appear as disconnected appendix sections at the bottom (lines 74-89) but are NOT integrated into the roster table or DAG.

### Category C: Wrong File Extensions
- `spec-change-requests.md` (lines 10, 71) → `spec-change-requests.yaml` (per AGENTS.md line 43, 65)
- `tasks.md` (line 11) → `tasks.yaml` (per AGENTS.md line 18, 27)

### Category D: Stale/Wrong Path
- `./ops/build/system-design.yaml` (line 88) uses `./ops/` prefix → should be `.ops/build/system-design.yaml` (per AGENTS.md line 23)

### Category E: Structural Issues
- The Architect section (lines 81-89) and Knowledge Synthesizer section (lines 74-79) are appended as disconnected blocks at the bottom instead of being integrated into the roster table, DAG, and auto-detection sections
- The `phipaa` typo in compliance keywords (line 46) — should be just `hipaa` (it appears twice: `phipaa` AND `hipaa`)
- Missing blank line between Message Protocol section and Knowledge Synthesizer section (line 73-74 — sections run together)

### Category F: Inconsistencies with orchestrate.md
orchestrate.md was just updated with these features that swarm-config.md should reflect:
- orchestrate.md reads `prd.md` first in step 1 — swarm-config.md prompt template doesn't mention prd.md
- orchestrate.md has version safety ("do not mix build versions") — swarm-config.md prompt template doesn't mention this
- orchestrate.md's keyword tables were expanded with ~18 new keywords — swarm-config.md already has these (they were the source), verify they still match exactly
- orchestrate.md says Tier 2 is "sequential, not parallel" — swarm-config.md DAG should make this explicit

## Review Dimensions

### Dimension 1: Roster/DAG Alignment
Every agent in AGENTS.md must appear in the roster table with the correct tier. The DAG visualization must match the 6-tier structure exactly.

### Dimension 2: Extension/Path Correctness
All file references must use the correct extensions (`.yaml` for tasks, system-design, spec-change-requests; `.md` for specs) and the correct `.ops/` prefix.

### Dimension 3: Completeness
architect and knowledge-synthesizer must be fully integrated into the roster, DAG, and auto-detection — not appended as afterthoughts. The disconnected sections at the bottom should be merged into the main structure.

### Dimension 4: Consistency with orchestrate.md
The prompt template and message protocol must align with how orchestrate.md actually spawns and communicates with agents.

### Dimension 5: Token Efficiency
This file is read on-demand by the orchestrator. Keep it structured for fast AI parsing. Tables > prose, no redundancy with AGENTS.md roster.

## Constraints
- Only modify `agents/swarm-config.md`
- Do NOT modify AGENTS.md, CLAUDE.md, orchestrate.md, or instructions.md
- Do NOT fabricate new agents, tiers, or workflow steps
- All changes must be traceable to the authoritative sources
- Merge the disconnected Architect and Knowledge Synthesizer sections into the main structure, then remove the appendix sections
- Preserve the auto-detection keywords (they are the authoritative source for keyword triggers)

## Process
1. Read current AGENTS.md
2. Read current CLAUDE.md
3. Read current `claude/commands/orchestrate.md`
4. Read current `agents/instructions.md`
5. Read current `agents/swarm-config.md`
6. Apply all fixes across categories A-F
7. Read back swarm-config.md to verify

## Output Format
For each change, provide:
```
### Change N: [Short title]
**Category**: [A-F]
**Source**: [Authoritative source and line/section]
**Current**: [What swarm-config.md says]
**Fixed**: [What it should say]
```

After all changes, provide summary table.

## Quality Criteria
- Roster table has all agents from AGENTS.md with correct tiers (1-6)
- DAG matches AGENTS.md 6-tier structure exactly
- Tier 2 explicitly marked as sequential (spec-writer → architect → project-task-planner)
- architect and knowledge-synthesizer integrated into roster and DAG (not appended)
- Zero references to `tasks.md` (should be `tasks.yaml`)
- Zero references to `spec-change-requests.md` (should be `.yaml`)
- `.ops/` prefix used everywhere (not `./ops/`)
- No `phipaa` typo
- Disconnected appendix sections removed (content merged into main structure)
- Keyword tables match orchestrate.md exactly
- Every change cites its authoritative source
- No fabricated content

## Quality Scores
- **Clarity**: 92%
- **Efficiency**: 88%
- **Structure**: 95%
- **Completeness**: 94%
- **Actionability**: 92%
- **Specificity**: 92%
- **Overall**: 92% (excellent)

## Original Prompt
```
based on CLAUDE.md, AGENTS.md, claude/commands/orchestrate.md, and agents/instructions.md, analyze agents/swarm-config.md, fix any mismatch and improve it based on your knowledge about Claude code agents. This is a config file for agents orchestratation.
```

## Validation Checklist
- [ ] Roster table includes ALL agents from AGENTS.md (18 agents)
- [ ] All tier numbers match AGENTS.md 6-tier DAG
- [ ] DAG visualization shows 6 tiers (not 7)
- [ ] Tier 2 marked sequential: spec-writer → architect → project-task-planner
- [ ] architect integrated into roster, DAG, and auto-detection
- [ ] knowledge-synthesizer integrated into roster, DAG, and auto-detection
- [ ] Zero `tasks.md` references (should be `tasks.yaml`)
- [ ] Zero `spec-change-requests.md` references (should be `.yaml`)
- [ ] `.ops/` prefix (not `./ops/`) everywhere
- [ ] No `phipaa` typo
- [ ] Disconnected appendix sections (lines 74-89) removed/merged
- [ ] Keyword tables match orchestrate.md
- [ ] Prompt template aligned with orchestrate.md spawning logic
- [ ] No fabricated content

## Edge Cases
- The roster table has a "Persistent?" column — only context-manager is "Yes". Verify this is still correct (knowledge-synthesizer may also be persistent since it logs deviations across tiers)
- `workflow-orchestrator` is listed in AGENTS.md T1 but doesn't need to be in the swarm-config roster since IT is the one reading this file — note this rather than adding it
- The `spec_change_requests` reference in the Architect section (line 89) uses underscores — should be `spec-change-requests.yaml` with hyphens per AGENTS.md
- The prompt template (lines 51-66) references `agents/<agent-name>.md` but AGENTS.md roster shows `.claude/agents/<agent-name>.md` for most agents — verify correct path
