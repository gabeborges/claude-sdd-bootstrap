---
id: comp-20260205-120000-c7d3
depthUsed: comprehensive
timestamp: 2026-02-05T12:00:00Z
executed: false
originalPrompt: "consolidate CLAUDE.MD and AGENTS.md removing duplicate and ambiguous content. Follow best practices for this 2 documents. Do not make things up. Make sure SDD rules are in the right place and core content is secure. You can rewrite things so it's more performatic for AI agents and consume less tokens."
---

# Improved Prompt

# Consolidate CLAUDE.md and AGENTS.md

## Objective
Consolidate CLAUDE.md and AGENTS.md into two clean, non-overlapping documents optimized for AI agent token consumption.

## Context
- This is a Claude Code bootstrap project (claude-sdd-bootstrap)
- CLAUDE.md is auto-loaded into every Claude Code session (token cost every turn)
- AGENTS.md is a project convention read on-demand by orchestrator agents
- Both files currently have overlapping content causing confusion and wasted tokens

## Rules

### Content Placement
- **CLAUDE.md** = project-wide rules that apply to ALL agents, every session (security, git, code style, testing commands, directory structure)
- **AGENTS.md** = agent coordination reference read on-demand (agent roster, tier dependencies, SDD workflow rules, delegation guide)

### What Belongs Where
| Content Type | Belongs In | Reason |
|---|---|---|
| Security/secrets rules | CLAUDE.md | Must be enforced every session |
| Git identity/conventions | CLAUDE.md | Applies to all agents |
| Tech stack constraints | CLAUDE.md | Universal project context |
| Testing commands | CLAUDE.md | Needed by any coding agent |
| SDD workflow rules | AGENTS.md | Only needed by orchestrator agents |
| Agent roster/roles | AGENTS.md | On-demand coordination reference |
| Tier dependencies | AGENTS.md | On-demand coordination reference |
| Coding standards | CLAUDE.md | Applies to all coding work |

### Consolidation Constraints
1. **No duplication** — if a rule appears in CLAUDE.md, do not repeat it in AGENTS.md
2. **No fabrication** — only use content from the existing files; do not invent new rules
3. **Preserve all security rules** — security content must not be lost or weakened
4. **Preserve all SDD rules** — SDD workflow definitions must remain intact
5. **Token optimization** — rewrite for conciseness:
   - Use bullet points over prose
   - Remove redundant explanations
   - Eliminate "obvious" rules Claude already follows by default
   - Prefer tables for structured data
6. **CLAUDE.md target: < 150 lines** — every line must earn its place
7. **Cross-reference, don't duplicate** — AGENTS.md can say "Follow security rules from CLAUDE.md" instead of repeating them

### Process
1. Read current CLAUDE.md fully
2. Read current AGENTS.md fully
3. Identify all duplicate/overlapping content between them
4. Decide placement per the "What Belongs Where" table above
5. Rewrite both files with zero overlap
6. Verify no security or SDD rules were lost

### Output
- Rewritten CLAUDE.md (< 150 lines, security-complete, token-optimized)
- Rewritten AGENTS.md (no CLAUDE.md overlap, SDD-complete, agent coordination only)

### Quality Criteria
- Zero content duplication between the two files
- All security rules from original CLAUDE.md preserved
- All SDD workflow rules preserved (in the correct file)
- CLAUDE.md < 150 lines
- Every line in CLAUDE.md passes: "would removing this cause mistakes?"
- AGENTS.md is self-contained for agent coordination (no need to also read CLAUDE.md for orchestration decisions)

## Quality Scores
- **Clarity**: 90%
- **Efficiency**: 85%
- **Structure**: 95%
- **Completeness**: 90%
- **Actionability**: 88%
- **Specificity**: 85%
- **Overall**: 89% (good)

## Original Prompt
```
consolidate CLAUDE.MD and AGENTS.md removing duplicate and ambiguous content. Follow best practices for this 2 documents. Do not make things up. Make sure SDD rules are in the right place and core content is secure. You can rewrite things so it's more performatic for AI agents and consume less tokens.
```

## Alternative Approaches

**1. Merge into Single File**
Combine everything into CLAUDE.md with sections. Simpler but makes CLAUDE.md longer and loads agent coordination info every session (wasted tokens for non-orchestrator agents).

**2. Three-File Split**
CLAUDE.md (security + project rules) + AGENTS.md (agent coordination) + SDD.md (SDD workflow rules). More granular but adds another file to manage.

**3. Two-File with @import (Recommended)**
CLAUDE.md stays lean (auto-loaded). AGENTS.md is on-demand. CLAUDE.md can @ import shared snippets if needed. Best balance of token efficiency and maintainability.

## Validation Checklist
- [ ] Every security rule from original CLAUDE.md exists in the new version
- [ ] Every SDD rule is present (in CLAUDE.md or AGENTS.md, not both)
- [ ] Zero duplicate content between the two files
- [ ] CLAUDE.md is under 150 lines
- [ ] No invented/fabricated rules — all content traceable to originals
- [ ] AGENTS.md doesn't repeat CLAUDE.md security rules
- [ ] Both files are valid markdown

## Edge Cases
- Rules that are both "project-wide" AND "agent-specific" — place in CLAUDE.md, reference from AGENTS.md
- SDD rules that include security constraints — keep security in CLAUDE.md, keep the SDD workflow reference in AGENTS.md
- Content that exists in CLAUDE.md but is redundant with Claude's default behavior — remove entirely from both files
