---
id: comp-20260205-180000-q8j3
depthUsed: comprehensive
timestamp: 2026-02-05T18:00:00Z
executed: false
originalPrompt: "you are a claude-code-specialist agent, use your knowledge about claude code agents to review all agents inside claude/agents and make them more effective, efficient, and high quality. CLAUDE.md, AGENTS.md, claude/commands/orchestrate.md, claude/agents/instructions.md and claude/agents/swarm-config.md are reference files. Do not make things up. Follow best practices for creating effective, efficient and high quality agents."
---

# Improved Prompt

# Quality Pass: Make All Agent System Prompts Effective, Efficient, and High Quality

## Objective
Rewrite every agent file in `agents/` to follow Claude Code agent best practices. The previous pass fixed *consistency* (references, extensions, paths). This pass fixes *quality* — making each agent's system prompt concise, actionable, and structured for optimal AI execution.

## Quality Standard and Anti-Pattern

**Quality standard**: `samples/agents/developer.md` — concise role definition, clear boundaries, structured rules, escalation protocol, verification checklist. ~250 lines for a complex agent, ~50–80 lines for a focused agent.

**Anti-pattern**: `samples/agents/workflow-orchestrator.md` — bloated keyword lists ("State persistence, Transition validation, Consistency checks, Rollback support, Version control, Migration strategies, Recovery procedures, Audit logging"), JSON communication protocol blocks that won't be used, fake progress metrics, vague checklists with no actionable criteria. This style wastes tokens and provides no operational value.

## The 8 Quality Rules (Apply to Every Agent)

### Rule 1: Token Budget
Each agent file becomes the system prompt when spawned. Every line costs tokens.
- Most agents: **50–100 lines** (focused role, clear rules, done)
- Complex agents (workflow-orchestrator, fullstack-developer): **100–150 lines max**
- If an agent file is over 150 lines, it's too long — prune

### Rule 2: Role Clarity (First 3 Lines)
The opening must answer: "What do you do, and what don't you do?"
- Line 1: What this agent IS and its primary mission
- Line 2-3: What this agent does NOT do (boundaries)
- No preamble, no "You are a senior X with expertise in Y and Z" fluff

**Good**: "You are the QA agent. You validate implementation against spec contracts. You do not write code or fix bugs — you report failures."
**Bad**: "You are a senior quality assurance engineer with deep expertise in testing methodologies, contract validation, exploratory testing, and quality metrics tracking."

### Rule 3: Actionable Over Descriptive
Every section must tell the agent WHAT TO DO, not describe WHAT IT KNOWS.
- Replace noun lists with imperative instructions
- Replace "X management" with "Do X by doing Y"
- If a bullet doesn't change the agent's behavior, delete it

**Good**: "Read `specs.md` first. For each scenario, verify the implementation produces the expected response shape."
**Bad**: "Contract validation, Response verification, Scenario coverage, Acceptance testing, Edge case handling"

### Rule 4: Structured I/O Contract
Every agent must have a clear input/output section:
- **Reads** (inputs): exact file paths the agent should read before starting
- **Writes** (outputs): exact file paths the agent produces or updates
- **Escalates**: when/how the agent reports problems it can't solve

### Rule 5: SDD Artifact Awareness
Every agent must know which SDD artifacts are relevant to its role:
- Use `.ops/` prefix (not `./ops/`)
- Reference correct file extensions (`.yaml` for tasks, system-design, spec-change-requests, checks, db-migration-plan; `.md` for specs)
- Planning agents: include prerequisite checks (prd→specs→system-design→tasks)
- Quality agents: reference `checks.yaml` for gate output
- Implementation agents: reference `implements:` pointers for traceability

### Rule 6: Escalation Protocol
Every agent that can detect problems must have an escalation section:
- Spec violations → create `spec-change-requests.yaml`
- Blockers → report to orchestrator with structured format
- Security/compliance findings → create remediation tickets in `tasks.yaml`
- Never silently diverge from spec

### Rule 7: No Redundancy with CLAUDE.md
CLAUDE.md is auto-loaded every turn. Agent files are loaded only when spawned.
- Do NOT repeat CLAUDE.md rules in agent files (security guardrails, git conventions, etc.)
- Agent files should contain ONLY role-specific instructions
- If an instruction applies to all agents, it belongs in CLAUDE.md or `instructions.md`, not individual files

### Rule 8: YAML Frontmatter
Every agent file must have consistent frontmatter:
```yaml
---
name: <filename-without-extension>
description: <1-line role summary — used for agent selection>
category: <orchestration|planning|design|implementation|quality|security|compliance>
tools: Read, Write, Edit, Glob, Grep  # only tools the agent actually needs
model: sonnet  # or opus for orchestrator
---
```

## Agents to Rewrite (18 Files)

Apply the 8 rules to each. Group by expected effort:

### Heavy Rewrite (likely bloated or structurally weak)
| # | File | Expected Issues |
|---|------|----------------|
| 1 | `workflow-orchestrator.md` | Likely verbose — complex role but should still be < 150 lines |
| 2 | `fullstack-developer.md` | Primary builder — may have accumulated scope creep |
| 3 | `security-engineer.md` | May have keyword-list padding for security topics |
| 4 | `compliance-engineer.md` | May mirror security-engineer's bloat pattern |

### Medium Rewrite (likely need structural improvements)
| # | File | Expected Issues |
|---|------|----------------|
| 5 | `spec-writer.md` | Planning agent — verify prerequisite chain, may need tightening |
| 6 | `architect.md` | Recently added — may already be decent |
| 7 | `project-task-planner.md` | Planning agent — verify prerequisite chain |
| 8 | `database-administrator.md` | May have excessive DB topic coverage |
| 9 | `ui-designer.md` | May reference stale output files |
| 10 | `frontend-designer.md` | May be too thin or too broad |

### Light Pass (likely just need tightening)
| # | File | Expected Issues |
|---|------|----------------|
| 11 | `qa.md` | Quality agent — verify checks.yaml reference |
| 12 | `test-automator.md` | Should be focused — verify structure |
| 13 | `debugger.md` | Focused role — may just need trimming |
| 14 | `code-reviewer.md` | Gate role — verify checks.yaml output |
| 15 | `security-auditor.md` | Audit role — may mirror security-engineer |
| 16 | `compliance-auditor.md` | Audit role — may mirror compliance-engineer |
| 17 | `context-manager.md` | Orchestration role — should be concise |
| 18 | `knowledge-synthesizer.md` | Recently added — likely already concise |

## Process

1. Read the claude-code-specialist agent file at `.claude/agents/claude-code-specialist.md` for Mode 3 quality criteria
2. Read `samples/agents/developer.md` as the quality standard
3. Read `samples/agents/workflow-orchestrator.md` as the anti-pattern
4. Read AGENTS.md for canonical roles, categories, and DAG
5. Read `agents/instructions.md` for I/O reference
6. Read `agents/swarm-config.md` for trigger conditions and tier mapping
7. For each agent file (in effort order — heavy first):
   a. Read the current file
   b. Assess against the 8 quality rules
   c. Rewrite the file applying all rules
   d. Verify the rewrite with Read tool
8. After all 18 files rewritten, produce summary report

## Constraints

- Only modify files in `agents/*.md`
- Do NOT modify `.claude/agents/claude-code-specialist.md`, AGENTS.md, CLAUDE.md, orchestrate.md, instructions.md, or swarm-config.md
- Do NOT change agent roles or responsibilities — only improve how they're expressed
- Do NOT fabricate new workflow steps, artifacts, or rules
- All content must trace to: the agent's current file, AGENTS.md, CLAUDE.md, instructions.md, or swarm-config.md
- Preserve each agent's unique operational logic while improving structure and conciseness
- Use `developer.md` structure as inspiration, not as a template to copy verbatim

## Output Format

### Per-File Report
```
### [agent-name].md
**Before**: [line count] lines
**After**: [line count] lines
**Rules applied**: [list of rule numbers]
**Key changes**:
- [what changed and why]
```

### Summary Table
| # | Agent File | Before | After | Delta | Rules Applied |
|---|-----------|--------|-------|-------|---------------|
| 1 | workflow-orchestrator.md | 120 | 95 | -25 | 1,2,3,4 |

### Quality Metrics (Post-Rewrite)
- Average agent file length: target < 80 lines
- Agents over 100 lines: target ≤ 3 (orchestrator, fullstack-developer, spec-writer)
- Agents under 40 lines: flag as possibly too thin
- Zero keyword-list padding remaining
- All agents have I/O contract section
- All agents have escalation section (where applicable)

## Quality Scores
- **Clarity**: 92%
- **Efficiency**: 88%
- **Structure**: 95%
- **Completeness**: 90%
- **Actionability**: 92%
- **Specificity**: 90%
- **Overall**: 91% (excellent)

## Original Prompt
```
you are a claude-code-specialist agent, use your knowledge about claude code agents to review all agents inside claude/agents and make them more effective, efficient, and high quality. CLAUDE.md, AGENTS.md, claude/commands/orchestrate.md, claude/agents/instructions.md and claude/agents/swarm-config.md are reference files. Do not make things up. Follow best practices for creating effective, efficient and high quality agents.
```

## Validation Checklist
- [ ] All 18 agent files reviewed and rewritten
- [ ] Rule 1 (token budget) applied — no file over 150 lines
- [ ] Rule 2 (role clarity) applied — first 3 lines define role + boundaries
- [ ] Rule 3 (actionable over descriptive) applied — zero keyword-list padding
- [ ] Rule 4 (I/O contract) applied — every agent has reads/writes/escalates
- [ ] Rule 5 (SDD awareness) applied — correct paths, extensions, prerequisites
- [ ] Rule 6 (escalation protocol) applied — all relevant agents have escalation
- [ ] Rule 7 (no CLAUDE.md redundancy) applied — no repeated global rules
- [ ] Rule 8 (frontmatter) applied — consistent YAML across all files
- [ ] `developer.md` quality pattern followed (concise + actionable)
- [ ] `workflow-orchestrator.md` anti-pattern avoided (no keyword lists)
- [ ] No fabricated content — all changes traceable to authoritative sources
- [ ] Summary report with before/after metrics for all 18 files
- [ ] Agent roles and responsibilities unchanged — only expression improved

## Edge Cases
- `workflow-orchestrator.md` is the most complex agent (manages the entire DAG) — allow up to 150 lines but it still needs to be actionable, not descriptive
- `knowledge-synthesizer.md` and `architect.md` were recently added — they may already be close to quality standard
- Some agents output files that aren't in AGENTS.md folder structure (e.g., `ui.md`, `security.md`, `compliance.md`) — these are feature-level working files; preserve these references but don't fabricate new ones
- The `context-manager.md` is "persistent" (stays active across tiers) — its prompt should reflect this unique behavior
- `claude-code-specialist.md` exists in both `agents/` and `.claude/agents/` — only modify the one in `agents/` if it exists; do NOT modify `.claude/agents/claude-code-specialist.md`
- Some agents may reference `samples/agents/developer.md` patterns — this is fine if it fits their role
- The `debugger.md` and `code-reviewer.md` may be very similar — ensure they have distinct, non-overlapping responsibilities
