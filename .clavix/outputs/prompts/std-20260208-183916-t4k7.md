---
id: std-20260208-183916-t4k7
depthUsed: standard
timestamp: 2026-02-08T18:39:16Z
executed: false
originalPrompt: "currently the agent swarm is consuming too many tokens to create a product. I need to reduce that. Analize sdd and files and propose changes to make this more efficient."
---

# Improved Prompt

## Objective

Reduce total token consumption of the SDD agent swarm pipeline so that a full feature build (T1→T6) fits within practical context limits without sacrificing SDD governance (spec traceability, gate enforcement, security/compliance).

## Scope — What to Analyze

Audit these files for token cost and redundancy:

1. **Agent system prompts** — `claude/agents/*.md` (19 files)
   - Measure approximate line count / token cost per agent
   - Identify duplicated content across agents (shared rules, repeated references)
   - Flag agents with examples/templates that could be moved to on-demand skills

2. **CLAUDE.md** — Auto-loaded every turn (~token cost per message)
   - Identify content that could move to skills (loaded on-demand, not always)

3. **Skill descriptions** — `.claude/skills/*/SKILL.md` and `.claude/commands/**/*.md`
   - Descriptions are auto-loaded; bodies are on-demand
   - Identify oversized descriptions consuming passive context

4. **Swarm orchestration overhead** — `claude/agents/swarm-config.md` + `claude/agents/instructions.md`
   - Evaluate if orchestration instructions can be compressed

5. **Cross-agent redundancy** — Content repeated across multiple agent files
   (e.g., spec-change-requests protocol, checks.yaml format, escalation rules)

## Analysis Framework

For each token reduction opportunity, report:

| Area | Current Cost | Proposed Change | Estimated Savings | Risk |
|------|-------------|-----------------|-------------------|------|
| {file/section} | {lines/tokens} | {what to change} | {lines/tokens saved} | {what could break} |

## Reduction Strategies to Evaluate

1. **Extract shared protocols to a single skill** — If 10+ agents reference the same protocol (e.g., spec-change-requests, checks.yaml merge-only), move it to one skill and have agents reference it instead of repeating it

2. **Compress agent prompts** — Apply the "developer.md quality standard" (concise + actionable, not keyword lists) to all agents

3. **Move examples/templates to skill bodies** — Agent prompts should define WHAT to do; examples of HOW go in on-demand skill references

4. **Reduce CLAUDE.md** — Move rarely-triggered rules to skills

5. **Merge similar agents** — Per the agent-to-skill-conversion-report.md, evaluate if any swarm agents can be combined (e.g., engineer+auditor pairs)

6. **Tier consolidation** — Evaluate if 6 tiers can be reduced (fewer sequential rounds = fewer context loads)

## Constraints

- Do NOT weaken SDD governance: spec traceability, gate enforcement, security/compliance checks must remain intact
- Do NOT remove agents that are part of the swarm tier DAG without proposing an equivalent replacement
- Preserve the artifact chain: specs.md → system-design.yaml → tasks.yaml
- Reference existing analysis: `.ops/analysis/agent-governance-report.md` and `.ops/analysis/agent-to-skill-conversion-report.md`

## Deliverable

Write a report to `.ops/analysis/token-efficiency-report.md` containing:
1. **Current state**: Token cost inventory (per agent, CLAUDE.md, skills)
2. **Reduction opportunities**: Ranked by savings (highest first)
3. **Recommended changes**: Specific file edits with before/after
4. **Risk assessment**: What each change could break
5. **Implementation order**: Which changes to apply first (safe → aggressive)

## Quality Scores
- **Clarity**: 88%
- **Efficiency**: 82%
- **Structure**: 90%
- **Completeness**: 90%
- **Actionability**: 90%
- **Specificity**: 85%
- **Overall**: 88% (good)

## Original Prompt
```
currently the agent swarm is consuming too many tokens to create a product. I need to reduce that. Analize sdd and files and propose changes to make this more efficient.
```
