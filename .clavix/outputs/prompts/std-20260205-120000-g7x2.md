---
id: std-20260205-120000-g7x2
depthUsed: standard
timestamp: 2026-02-05T12:00:00Z
executed: false
originalPrompt: "inside samples folder you will find product-vision-strategy.md and prd.md. The product-vision-strategy.md file is created in the begining of the project and contains a lot of defitinions that are then enforced downstream. The prd.md file is generated based on the build version. It also contains a lot of information that are useful/important downstream. A lot of definitions from CLAUDE.md comes from the product-vision-strategy.md file. I need you to take a look at these files and think how could this impact agents? How can this impact the planning of what we are building? How can we make sure that only the right agents are reading these files? How can we make sure that the information inside these files are actually being consumed and inferring the product development? Create a plan to analyse this and generate an implementation report."
---

# Improved Prompt

Analyze how `samples/product-vision-strategy.md` and `samples/prd.md` flow through the SDD agent swarm and identify gaps in how their content reaches downstream artifacts.

## Context

- `product-vision-strategy.md` is created once at project start. It defines vision, target customers, tech stack, compliance posture, AI strategy, data principles, and architectural approach. Many CLAUDE.md rules originate from this file.

- `prd.md` is generated per build version. It defines scope, must-have features, constraints, integration points, and success metrics for that version.

- Both files contain critical definitions that should constrain and inform all downstream work (specs, system design, tasks, implementation).

## Analysis Required

### 1. Information Flow Audit
- Trace which agents currently read these files (directly or indirectly).
- Identify which critical definitions from each file (compliance rules, data principles, AI boundaries, non-goals, tech constraints) actually propagate into specs.md, system-design.yaml, and tasks.yaml.
- Flag definitions that are likely LOST between documents (present in vision/PRD but absent from downstream artifacts).

### 2. Agent Access Governance
- Map which agents SHOULD read each file vs which currently do.
- Identify agents that read these files unnecessarily (token waste).
- Identify agents that SHOULD reference these files but don't (e.g., compliance-engineer should reference compliance posture from vision; security-engineer should reference security assumptions).
- Propose explicit read/no-read rules per agent for both files.

### 3. Enforcement Gap Analysis
- Identify definitions in product-vision-strategy.md that are NOT enforced anywhere in the agent pipeline (e.g., "no silent writes," "fail-closed AI," data residency requirements).
- Check whether PRD constraints (e.g., "Canada-only data residency," "HIPAA/PHIPA from day 0") have corresponding checks in the compliance-auditor or security-auditor agent workflows.
- Identify any CLAUDE.md rules that duplicate vision content vs rules that should exist but don't.

### 4. Token Efficiency
- CLAUDE.md currently says "do NOT read product-vision-strategy.md unless needed." Evaluate whether key definitions should instead be distilled into agent-specific context (smaller, targeted extracts) rather than loading the full 400-line file.
- Propose a "context distillation" strategy: which definitions should be embedded in which agent files vs loaded on-demand.

## Expected Output

Generate an implementation report (markdown) with:
1. **Current State Matrix** — Table mapping each agent to what it reads, what it should read, and gaps
2. **Information Loss Map** — Definitions from vision/PRD that don't reach downstream artifacts
3. **Recommended Changes** — Specific edits to agent files, CLAUDE.md, and/or new gate checks
4. **Priority Ranking** — Changes ordered by impact (compliance/security gaps first, token optimization last)

Save the report to `.ops/build/analysis/` (create directory if needed).

## Quality Scores
- **Clarity**: 90%
- **Efficiency**: 85%
- **Structure**: 90%
- **Completeness**: 90%
- **Actionability**: 90%
- **Specificity**: 85%
- **Overall**: 88% (good)

## Original Prompt
```
inside samples folder you will find product-vision-strategy.md and prd.md. The product-vision-strategy.md file is created in the begining of the project and contains a lot of defitinions that are then enforced downstream. The prd.md file is generated based on the build version. It also contains a lot of information that are useful/important downstream. A lot of definitions from CLAUDE.md comes from the product-vision-strategy.md file. I need you to take a look at these files and think how could this impact agents? How can this impact the planning of what we are building? How can we make sure that only the right agents are reading these files? How can we make sure that the information inside these files are actually being consumed and inferring the product development? Create a plan to analyse this and generate an implementation report.
```
