---
id: comp-20260205-173000-r6w9
depthUsed: comprehensive
timestamp: 2026-02-05T17:30:00Z
executed: false
originalPrompt: "review all agents files inside claude/agents for inconsistencies based on CLAUDE.md, AGENTS.md, claude/commands/orchestrate.md, claude/agents/instructions.md and claude/agents/swarm-config.md. Do not make things up."
---

# Improved Prompt

# Review All Agent Files for Inconsistencies with Authoritative Sources

## Objective
Systematically review every agent definition file for inconsistencies with the project's authoritative sources. Fix file extension references, stale terminology, missing SDD rules, and structural issues. This is a bulk consistency pass — apply the same checks to every agent file.

## Scope: 18 Agent Files to Review

All files in `agents/` (excluding `instructions.md` and `swarm-config.md` which were already fixed):

| # | File | Agent Name | Category |
|---|------|-----------|----------|
| 1 | `agents/workflow-orchestrator.md` | Workflow Orchestrator | orchestration |
| 2 | `agents/context-manager.md` | Context Manager | orchestration |
| 3 | `agents/knowledge-synthesizer.md` | Knowledge Synthesizer | orchestration |
| 4 | `agents/spec-writer.md` | Spec Writer | planning |
| 5 | `agents/architect.md` | Architect | planning |
| 6 | `agents/project-task-planner.md` | Project Task Planner | planning |
| 7 | `agents/ui-designer.md` | UI Designer | design |
| 8 | `agents/frontend-designer.md` | Frontend Designer | design |
| 9 | `agents/fullstack-developer.md` | Fullstack Developer | implementation |
| 10 | `agents/database-administrator.md` | Database Administrator | implementation |
| 11 | `agents/qa.md` | QA | quality |
| 12 | `agents/test-automator.md` | Test Automator | quality |
| 13 | `agents/debugger.md` | Debugger | quality |
| 14 | `agents/code-reviewer.md` | Code Reviewer | quality |
| 15 | `agents/security-engineer.md` | Security Engineer | security |
| 16 | `agents/security-auditor.md` | Security Auditor | security |
| 17 | `agents/compliance-engineer.md` | Compliance Engineer | compliance |
| 18 | `agents/compliance-auditor.md` | Compliance Auditor | compliance |

Also check: `.claude/agents/claude-code-specialist.md` (exists in both locations — may be a duplicate)

## Authoritative Sources (in order)
1. **AGENTS.md** — canonical roster, roles, categories, 6-tier DAG, SDD artifact definitions, folder structure
2. **CLAUDE.md** — project rules, SDD flow, security guardrails
3. **claude/commands/orchestrate.md** — orchestration skill (how agents are actually spawned)
4. **agents/instructions.md** — agent I/O reference (just updated)
5. **agents/swarm-config.md** — swarm config (just updated)

## Checks to Apply to EVERY Agent File

### Check 1: File Extension References
Search each agent file for stale `.md` references that should be `.yaml`:
- `tasks.md` → `tasks.yaml`
- `system-design.md` → `system-design.yaml`
- `spec-change-requests.md` → `spec-change-requests.yaml`
- `checks.md` → `checks.yaml` (if referenced)

`specs.md` stays as `.md` — do NOT change this.

### Check 2: Stale Terminology
Search for terms the project no longer uses:
- `OpenSpec` → remove or replace with `SDD`
- `Clavix intent` → remove (not part of current workflow)
- `proposal.md` → remove (not in AGENTS.md folder structure)
- `design.md` (when referring to system design) → `system-design.yaml`

### Check 3: Artifact Path Consistency
Verify all file path references match AGENTS.md folder structure:
- `specs.md` should be at `.ops/build/v{x}/<feature-name>/specs.md`
- `tasks.yaml` should be at `.ops/build/v{x}/<feature-name>/tasks.yaml`
- `system-design.yaml` should be at `.ops/build/system-design.yaml` (build-level, not version-scoped)
- `decisions-log.md` should be at `.ops/build/decisions-log.md` (build-level only)
- `prd.md` should be at `.ops/build/v{x}/prd.md`
- Use `.ops/` prefix (not `./ops/`)

### Check 4: Role/Category Match
Verify each agent's role description and category match AGENTS.md roster (lines 97-116):
- Role name matches
- Category matches (orchestration, planning, design, implementation, quality, security, compliance)

### Check 5: SDD Prerequisite Awareness
Planning agents (spec-writer, architect, project-task-planner) should reference the SDD prerequisite chain:
- spec-writer: must check that `prd.md` exists before creating `specs.md`
- architect: must check that `specs.md` exists before creating `system-design.yaml`
- project-task-planner: must check that both `specs.md` AND `system-design.yaml` exist before creating `tasks.yaml`

### Check 6: YAML Frontmatter Consistency
Each agent file should have consistent YAML frontmatter. Check that:
- `name` field matches the filename (e.g., `spec-writer` for `spec-writer.md`)
- `description` field is present and concise
- Fields present are reasonable for an agent definition

### Check 7: Spec-Change-Request Escalation
Agents that can detect spec violations should reference `spec-change-requests.yaml` (not `.md`) as the escalation mechanism. Check agents that are likely to detect violations:
- architect, fullstack-developer, qa, security-engineer, compliance-engineer, database-administrator

## Known Systemic Issue: File Path Discrepancy

**AGENTS.md roster declares all agent paths as `.claude/agents/<name>.md`** (lines 99-116).
**Actual files on disk live at `agents/<name>.md`** (no dot prefix).

This is a systemic discrepancy. Options:
1. Fix AGENTS.md paths to match disk reality (`agents/`)
2. Move files to `.claude/agents/` to match AGENTS.md
3. Leave as-is and note the discrepancy

**Decision needed from user** — flag this but do not move files without confirmation. For now, fix internal references within agent files to be self-consistent.

Also: `claude-code-specialist.md` exists in BOTH `agents/` and `.claude/agents/` — flag this duplicate.

## Constraints
- Only modify files in `agents/*.md` and `.claude/agents/*.md`
- Do NOT modify AGENTS.md, CLAUDE.md, orchestrate.md, instructions.md, or swarm-config.md
- Do NOT fabricate new rules, roles, or workflow steps
- All changes must be traceable to the authoritative sources
- Do NOT change agent behavior/logic — only fix references, terminology, and structural consistency
- Preserve each agent's unique role definition and operational instructions
- "Do not make things up" — only fix what demonstrably contradicts the authoritative sources

## Process
1. Read AGENTS.md, CLAUDE.md, orchestrate.md (for reference — already in context from earlier work)
2. For each of the 18 agent files:
   a. Read the file
   b. Apply Checks 1-7
   c. If inconsistencies found: fix them
   d. If no inconsistencies: note "clean" and move on
3. After all files reviewed, read back any modified files to verify
4. Produce a summary report

## Output Format

### Per-File Report
For each agent file, report:
```
### [agent-name].md
**Status**: [clean | N fixes applied]
**Fixes** (if any):
- [Check #]: [what was wrong] → [what was fixed] (Source: [authoritative source])
```

### Summary Table
After all files:
| # | Agent File | Status | Fixes |
|---|-----------|--------|-------|
| 1 | workflow-orchestrator.md | 3 fixes | tasks.md→.yaml, OpenSpec removed, ... |
| 2 | context-manager.md | clean | — |
| ... | ... | ... | ... |

### Systemic Issues
List any issues that affect multiple files or require user decision (like the path discrepancy).

## Quality Criteria
- All 18 agent files reviewed (none skipped)
- Zero remaining `tasks.md` references across all files (should be `tasks.yaml`)
- Zero remaining `spec-change-requests.md` references (should be `.yaml`)
- Zero remaining `OpenSpec` references
- Zero remaining `./ops/` prefix (should be `.ops/`)
- Planning agents have prerequisite checks
- Every change cites its authoritative source
- No fabricated content
- Summary report covers all 18 files

## Quality Scores
- **Clarity**: 92%
- **Efficiency**: 85%
- **Structure**: 95%
- **Completeness**: 92%
- **Actionability**: 90%
- **Specificity**: 92%
- **Overall**: 91% (excellent)

## Original Prompt
```
review all agents files inside claude/agents for inconsistencies based on CLAUDE.md, AGENTS.md, claude/commands/orchestrate.md, claude/agents/instructions.md and claude/agents/swarm-config.md. Do not make things up.
```

## Validation Checklist
- [ ] All 18 agent files read and reviewed
- [ ] Check 1 (file extensions) applied to all files
- [ ] Check 2 (stale terminology) applied to all files
- [ ] Check 3 (artifact paths) applied to all files
- [ ] Check 4 (role/category match) applied to all files
- [ ] Check 5 (SDD prerequisites) applied to planning agents
- [ ] Check 6 (frontmatter) applied to all files
- [ ] Check 7 (spec-change-request escalation) applied to relevant agents
- [ ] Summary report produced with per-file status
- [ ] Systemic path discrepancy (agents/ vs .claude/agents/) flagged
- [ ] Duplicate claude-code-specialist.md flagged
- [ ] No fabricated content

## Edge Cases
- Some agent files may be very short (just frontmatter + 1 paragraph) — still apply all checks
- The `workflow-orchestrator.md` agent file may reference orchestrate.md — verify it doesn't contradict
- `claude-code-specialist.md` exists in both `agents/` and `.claude/agents/` — flag as duplicate, do not modify without user decision
- Some agents may reference `ui.md`, `security.md`, or `compliance.md` as outputs — these are stale per AGENTS.md folder structure (removed in instructions.md update)
- The `knowledge-synthesizer.md` and `architect.md` were recently added — they may already be consistent since they're newer
